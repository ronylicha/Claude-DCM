[Unit]
Description=Context Manager API (Bun/Hono)
Documentation=file:///home/rony/.claude/services/context-manager/README.md
After=network.target postgresql.service
StartLimitBurst=3
StartLimitIntervalSec=60

[Service]
Type=simple
User=rony
Group=rony
WorkingDirectory=/home/rony/.claude/services/context-manager

# Environment from .env file
EnvironmentFile=/home/rony/.claude/services/context-manager/.env

# Main process
ExecStart=/home/rony/.nvm/versions/node/v22.17.0/bin/bun run src/server.ts

# Graceful shutdown
KillMode=mixed
KillSignal=SIGTERM
TimeoutStopSec=30

# Restart policy - on-failure to avoid infinite loops
Restart=on-failure
RestartSec=10

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=context-manager-api

# Security hardening
NoNewPrivileges=true
ProtectSystem=strict
ProtectHome=read-only
ReadWritePaths=/home/rony/.claude/services/context-manager
PrivateTmp=true

# Resource limits
LimitNOFILE=65536
MemoryMax=512M

[Install]
WantedBy=multi-user.target
